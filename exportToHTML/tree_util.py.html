<html>
<head>
<title>tree_util.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #629755; font-style: italic;}
.s3 { color: #cc7832;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
tree_util.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright 2018 The JAX Authors.</span>
<span class="s0">#</span>
<span class="s0"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="s0"># you may not use this file except in compliance with the License.</span>
<span class="s0"># You may obtain a copy of the License at</span>
<span class="s0">#</span>
<span class="s0">#     https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="s0">#</span>
<span class="s0"># Unless required by applicable law or agreed to in writing, software</span>
<span class="s0"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="s0"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="s0"># See the License for the specific language governing permissions and</span>
<span class="s0"># limitations under the License.</span>

<span class="s2">&quot;&quot;&quot;Utilities for working with tree-like container data structures. 
 
This module provides a small set of utility functions for working with tree-like 
data structures, such as nested tuples, lists, and dicts. We call these 
structures pytrees. They are trees in that they are defined recursively (any 
non-pytree is a pytree, i.e. a leaf, and any pytree of pytrees is a pytree) and 
can be operated on recursively (object identity equivalence is not preserved by 
mapping operations, and the structures cannot contain reference cycles). 
 
The set of Python types that are considered pytree nodes (e.g. that can be 
mapped over, rather than treated as leaves) is extensible. There is a single 
module-level registry of types, and class hierarchy is ignored. By registering a 
new pytree node type, that type in effect becomes transparent to the utility 
functions in this file. 
 
The primary purpose of this module is to enable the interoperability between 
user defined data structures and JAX transformations (e.g. `jit`). This is not 
meant to be a general purpose tree-like data structure handling library. 
 
See the `JAX pytrees note &lt;pytrees.html&gt;`_ 
for examples. 
&quot;&quot;&quot;</span>

<span class="s0"># Note: import &lt;name&gt; as &lt;name&gt; is required for names to be exported.</span>
<span class="s0"># See PEP 484 &amp; https://github.com/google/jax/issues/7570</span>

<span class="s3">from </span><span class="s1">jax._src.tree_util </span><span class="s3">import </span><span class="s1">(</span>
  <span class="s1">Partial </span><span class="s3">as </span><span class="s1">Partial</span><span class="s3">,</span>
  <span class="s1">PyTreeDef </span><span class="s3">as </span><span class="s1">PyTreeDef</span><span class="s3">,</span>
  <span class="s1">all_leaves </span><span class="s3">as </span><span class="s1">all_leaves</span><span class="s3">,</span>
  <span class="s1">build_tree </span><span class="s3">as </span><span class="s1">build_tree</span><span class="s3">,</span>
  <span class="s1">register_pytree_node </span><span class="s3">as </span><span class="s1">register_pytree_node</span><span class="s3">,</span>
  <span class="s1">register_pytree_node_class </span><span class="s3">as </span><span class="s1">register_pytree_node_class</span><span class="s3">,</span>
  <span class="s1">tree_all </span><span class="s3">as </span><span class="s1">tree_all</span><span class="s3">,</span>
  <span class="s1">tree_flatten </span><span class="s3">as </span><span class="s1">tree_flatten</span><span class="s3">,</span>
  <span class="s1">tree_leaves </span><span class="s3">as </span><span class="s1">tree_leaves</span><span class="s3">,</span>
  <span class="s1">tree_map </span><span class="s3">as </span><span class="s1">tree_map</span><span class="s3">,</span>
  <span class="s1">tree_reduce </span><span class="s3">as </span><span class="s1">tree_reduce</span><span class="s3">,</span>
  <span class="s1">tree_structure </span><span class="s3">as </span><span class="s1">tree_structure</span><span class="s3">,</span>
  <span class="s1">tree_transpose </span><span class="s3">as </span><span class="s1">tree_transpose</span><span class="s3">,</span>
  <span class="s1">tree_unflatten </span><span class="s3">as </span><span class="s1">tree_unflatten</span><span class="s3">,</span>
  <span class="s1">treedef_children </span><span class="s3">as </span><span class="s1">treedef_children</span><span class="s3">,</span>
  <span class="s1">treedef_is_leaf </span><span class="s3">as </span><span class="s1">treedef_is_leaf</span><span class="s3">,</span>
  <span class="s1">treedef_tuple </span><span class="s3">as </span><span class="s1">treedef_tuple</span><span class="s3">,</span>
  <span class="s1">register_pytree_with_keys </span><span class="s3">as </span><span class="s1">register_pytree_with_keys</span><span class="s3">,</span>
  <span class="s1">register_pytree_with_keys_class </span><span class="s3">as </span><span class="s1">register_pytree_with_keys_class</span><span class="s3">,</span>
  <span class="s1">tree_map_with_path </span><span class="s3">as </span><span class="s1">tree_map_with_path</span><span class="s3">,</span>
  <span class="s1">tree_flatten_with_path </span><span class="s3">as </span><span class="s1">tree_flatten_with_path</span><span class="s3">,</span>
  <span class="s1">keystr </span><span class="s3">as </span><span class="s1">keystr</span><span class="s3">,</span>
  <span class="s1">SequenceKey </span><span class="s3">as </span><span class="s1">SequenceKey</span><span class="s3">,</span>
  <span class="s1">DictKey </span><span class="s3">as </span><span class="s1">DictKey</span><span class="s3">,</span>
  <span class="s1">GetAttrKey </span><span class="s3">as </span><span class="s1">GetAttrKey</span><span class="s3">,</span>
  <span class="s1">FlattenedIndexKey </span><span class="s3">as </span><span class="s1">FlattenedIndexKey</span><span class="s3">,</span>
  <span class="s0"># TODO(ivyzheng): Remove these old APIs after June 10 2023.</span>
  <span class="s1">register_keypaths</span><span class="s3">,</span>
  <span class="s1">AttributeKeyPathEntry</span><span class="s3">,</span>
  <span class="s1">GetitemKeyPathEntry</span><span class="s3">,</span>
<span class="s1">)</span>
</pre>
</body>
</html>